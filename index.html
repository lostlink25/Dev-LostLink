<!DOCTYPE HTML>
     <html>
         <head>
             <title>LostLink - Home</title>
             <meta charset="utf-8" />
             <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
             <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline' 'unsafe-eval' https://accounts.google.com https://www.gstatic.com https://apis.google.com https://embed.tawk.to; object-src 'none'; base-uri 'self';" />
             <link rel="stylesheet" href="assets/css/main.css" />
             <noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
             <style>
                 .chatbot-button {
                     position: fixed;
                     bottom: 20px;
                     left: 20px;
                     background: #df7366;
                     color: #fff;
                     border-radius: 50%;
                     width: 60px;
                     height: 60px;
                     display: flex;
                     align-items: center;
                     justify-content: center;
                     cursor: pointer;
                     z-index: 10001;
                     -moz-transition: background-color 0.35s ease-in-out;
                     -webkit-transition: background-color 0.35s ease-in-out;
                     -ms-transition: background-color 0.35s ease-in-out;
                     transition: background-color 0.35s ease-in-out;
                 }
                 .chatbot-button:hover {
                     background: #ef8376;
                 }
                 .chatbot-window {
                     display: none;
                     position: fixed;
                     bottom: 100px;
                     left: 20px;
                     width: 300px;
                     max-height: 400px;
                     background: #fff;
                     border-radius: 8px;
                     box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
                     z-index: 10001;
                     overflow: hidden;
                 }
                 .chatbot-window.open {
                     display: block;
                 }
                 .chatbot-header {
                     background: #df7366;
                     color: #fff;
                     padding: 10px;
                     font-size: 1.2em;
                     text-align: center;
                 }
                 .chatbot-messages {
                     padding: 10px;
                     height: 300px;
                     overflow-y: auto;
                     font-size: 0.9em;
                 }
                 .chatbot-message {
                     margin: 5px 0;
                     padding: 8px;
                     border-radius: 5px;
                 }
                 .chatbot-message.bot {
                     background: #f0f4f4;
                     color: #5b5b5b;
                 }
                 .chatbot-message.user {
                     background: #df7366;
                     color: #fff;
                     text-align: right;
                 }
                 .chatbot-input {
                     display: flex;
                     border-top: 1px solid #ccc;
                 }
                 .chatbot-input input {
                     flex: 1;
                     border: none;
                     padding: 10px;
                     font-size: 0.9em;
                 }
                 .chatbot-input button {
                     background: #df7366;
                     color: #fff;
                     border: none;
                     padding: 10px;
                     cursor: pointer;
                     -moz-transition: background-color 0.35s ease-in-out;
                     -webkit-transition: background-color 0.35s ease-in-out;
                     -ms-transition: background-color 0.35s ease-in-out;
                     transition: background-color 0.35s ease-in-out;
                 }
                 .chatbot-input button:hover {
                     background: #ef8376;
                 }
                 .error {
                     color: red;
                     font-size: 0.9em;
                     text-align: center;
                     margin: 5px 0;
                 }
             </style>
         </head>
         <body class="homepage is-preload">
             <div id="page-wrapper">
                 <!-- Header -->
                 <div id="header">
                     <!-- Inner -->
                     <div class="inner">
                         <header>
                             <h1><a id="logo">LostLink</a></h1>
                             <hr />
                             <p>Airline & Airport Lost Items Tracking System</p>
                         </header>
                         <footer>
                             <a href="#banner" class="button circled scrolly">Start</a>
                         </footer>
                     </div>

                     <!-- Nav -->
                     <nav id="nav">
                         <ul>
                             <li><a href="index.html">Home</a></li>
                             <li><a href="About_Us.html">About Us</a></li>
                             <li><a href="Report_Lost_Items.html">Report Lost Items</a></li>
                             <li><a href="track_your_item.html">Track Items</a></li>
                             <li><a href="claim_item.html">Claim Items</a></li>
                             <li><a href="contact_support.html">Contact Us</a></li>
                         </ul>
                     </nav>
                 </div>

                 <!-- Banner -->
                 <section id="banner">
                     <header>
                         <h2>Hi. Welcome to <strong>LostLink</strong>.</h2>
                         <p>A new standard for operational excellence in the travel industry.</p>
                     </header>
                 </section>

                 <!-- Carousel -->
                 <section class="carousel">
                     <div class="reel">
                         <article>
                             <a href="Report_Lost_Items.html" class="image featured"><img src="images/pic01.jpg" alt="" /></a>
                             <header>
                                 <h3><a href="Report_Lost_Items.html">Report Lost Items</a></h3>
                             </header>
                             <p>Submit info about stuff you lost to start finding it.</p>
                         </article>
                         <article>
                             <a href="track_your_item.html" class="image featured"><img src="images/pic02.jpg" alt="" /></a>
                             <header>
                                 <h3><a href="track_your_item.html">Track Item</a></h3>
                             </header>
                             <p>Check where your lost item is or its status.</p>
                         </article>
                         <article>
                             <a href="claim_item.html" class="image featured"><img src="images/claim.jpg" alt="" /></a>
                             <header>
                                 <h3><a href="claim_item.html">Claim Item</a></h3>
                             </header>
                             <p>Say a found item is yours and get it back.</p>
                         </article>
                         <article>
                             <a href="login_staff.html" class="image featured"><img src="images/staff.jpg" alt="" /></a>
                             <header>
                                 <h3><a href="login_staff.html">Login (Staff)</a></h3>
                             </header>
                             <p>Sign in as staff to check status and report found items.</p>
                         </article>
                         <article>
                             <a href="contact_support.html" class="image featured"><img src="images/contact.jpg" alt="" /></a>
                             <header>
                                 <h3><a href="contact_support.html">Contact Support</a></h3>
                             </header>
                             <p>Reach out to the support team for help or questions.</p>
                         </article>
                     </div>
                 </section>

                 <!-- Main -->
                 <div class="wrapper style2">
                     <article id="main" class="container special">
                         <header>
                             <h2><a href="About_Us.html">Reuniting You with Your Belongings</a></h2>
                             <p>LostLink is your trusted partner in recovering lost items at airports, offering a seamless platform to report, track, and claim your belongings.</p>
                         </header>
                         <p>At LostLink, we understand how stressful it can be to lose personal items during travel. Our innovative platform simplifies the lost and found process, connecting passengers with their belongings through real-time tracking, a comprehensive found items database, and a secure claiming process. Whether youâ€™ve misplaced a wallet, a bag, or an electronic device, LostLink is here to help you every step of the way. Our dedicated team works closely with airport staff to ensure quick and accurate recovery, making travel worry-free.</p>
                         <footer>
                             <a href="About_Us.html" class="button">Learn More About Us</a>
                         </footer>
                     </article>
                 </div>

                 <!-- Features -->
                 <div class="wrapper style1">
                     <section id="features" class="container special">
                         <header>
                             <h2>Key Features of LostLink</h2>
                             <p>Explore the tools that make recovering your lost items fast and easy.</p>
                         </header>
                         <div class="row">
                             <article class="col-4 col-12-mobile special">
                                 <a href="Report_Lost_Items.html" class="image featured"><img src="images/pic01.jpg" alt="Report Lost Items" /></a>
                                 <header>
                                     <h3><a href="Report_Lost_Items.html">Report Lost Items</a></h3>
                                 </header>
                                 <p>Quickly submit details about your lost item to initiate the recovery process. Provide descriptions, locations, and images to help us find it faster.</p>
                             </article>
                             <article class="col-4 col-12-mobile special">
                                 <a href="track_your_item.html" class="image featured"><img src="images/pic02.jpg" alt="Track Your Item" /></a>
                                 <header>
                                     <h3><a href="track_your_item.html">Track Your Item</a></h3>
                                 </header>
                                 <p>Monitor the status of your lost item in real time with our tracking system, receiving updates on its location and recovery progress.</p>
                             </article>
                             <article class="col-4 col-12-mobile special">
                                 <a href="claim_item.html" class="image featured"><img src="images/pic03.jpg" alt="Claim Item" /></a>
                                 <header>
                                     <h3><a href="claim_item.html">Claim Your Item</a></h3>
                                 </header>
                                 <p>Identify and claim your found item securely through our verification process, ensuring itâ€™s returned to you promptly.</p>
                             </article>
                         </div>
                     </section>
                 </div>

                 <!-- Footer -->
                 <div id="footer">
                     <div class="container">
                         <div class="row">
                             <div class="col-12">
                                 <!-- Contact -->
                                 <section class="contact">
                                     <header>
                                         <h3>Need Help with a Lost Item?</h3>
                                     </header>
                                     <p>Contact our 24/7 support team or visit our Lost and Found office at the airport.</p>
                                     <ul class="icons">
                                         <li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
                                         <li><a href="https://www.facebook.com" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
                                         <li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
                                         <li><a href="#" class="icon brands fa-pinterest"><span class="label">Pinterest</span></a></li>
                                         <li><a href="#" class="icon brands fa-dribbble"><span class="label">Dribbble</span></a></li>
                                         <li><a href="#" class="icon brands fa-linkedin-in"><span class="label">Linkedin</span></a></li>
                                     </ul>
                                 </section>

                                 <!-- Copyright -->
                                 <div class="copyright">
                                     <ul class="menu">
                                         <li>Â© LostLink. All rights reserved.</li>
                                         <li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
                                     </ul>
                                 </div>

                                 <!-- Chatbot -->
                                 <div class="chatbot-button" onclick="toggleChatbot()">
                                     <span>ðŸ¤–</span>
                                 </div>
                                 <div class="chatbot-window" id="chatbotWindow">
                                     <div class="chatbot-header">
                                         LostLink Chatbot
                                         <span class="close-btn" onclick="toggleChatbot()">âœ–</span>
                                     </div>
                                     <div class="chatbot-messages" id="chatbotMessages">
                                         <div class="chatbot-message bot">Hello! How can I assist you with your lost items?</div>
                                     </div>
                                     <div class="chatbot-input">
                                         <input type="text" id="chatbotInput" placeholder="Type your message..." onkeypress="if(event.key === 'Enter') sendMessage()" />
                                         <button onclick="sendMessage()">Send</button>
                                     </div>
                                     <p class="error" id="chatbotError" style="display: none;"></p>
                                 </div>
                             </div>
                         </div>
                     </div>
                 </div>
             </div>

             <!-- Scripts -->
             <script src="https://accounts.google.com/gsi/client" async defer></script>
             <script src="https://apis.google.com/js/api.js"></script>
             <script src="assets/js/jquery.min.js"></script>
             <script src="assets/js/jquery.dropotron.min.js"></script>
             <script src="assets/js/jquery.scrolly.min.js"></script>
             <script src="assets/js/jquery.scrollex.min.js"></script>
             <script src="assets/js/browser.min.js"></script>
             <script src="assets/js/breakpoints.min.js"></script>
             <script src="assets/js/util.js"></script>
             <script src="assets/js/main.js"></script>
             <script>
                 // Chatbot functionality
                 let chatState = 'initial';
                 let lastUserTopic = '';
                 const formData = {
                     itemId: '',
                     itemType: '',
                     airport: '',
                     description: '',
                     foundDate: '',
                     foundLocation: '',
                     reportedBy: ''
                 };
                 const validItemTypes = ['electronics', 'clothing', 'luggage', 'jewelry', 'other'];
                 const validAirports = ['LAX', 'JFK', 'ORD', 'ATL', 'DFW'];

                 // Google API configuration
                     const CLIENT_ID = '321609158255-091oanamuil8009na1t2ajdk6190p5d0.apps.googleusercontent.com';
                     const SPREADSHEET_ID = '1Ua03tbd9imSPsGRjuFi7FLN0YAXW9GSKMPBrrlHd8Wc';
                     const SCOPES = 'https://www.googleapis.com/auth/spreadsheets';
					 
                 // Initialize gapi.client for Sheets API
                 function initGapiClient() {
                     return new Promise((resolve, reject) => {
                         gapi.load('client', () => {
                             gapi.client.init({
                                 discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4']
                             }).then(() => {
                                 console.log('gapi client initialized');
                                 resolve();
                             }).catch(error => {
                                 console.error('gapi client initialization error:', error);
                                 reject(error);
                             });
                         });
                     });
                 }

                 // Initialize GIS OAuth
                 function getAccessToken() {
                     return new Promise((resolve, reject) => {
                         const client = google.accounts.oauth2.initTokenClient({
                             client_id: CLIENT_ID,
                             scope: SCOPES,
                             prompt: 'select_account',
                             callback: (response) => {
                                 if (response.error) {
                                     console.error('OAuth error:', response.error);
                                     if (response.error === 'access_denied') {
                                         reject(new Error('Access denied: Please ensure your account is approved as a tester or contact the developer.'));
                                     } else {
                                         reject(new Error(response.error));
                                     }
                                 } else {
                                     console.log('Access token received');
                                     resolve(response.access_token);
                                 }
                             }
                         });
                         client.requestAccessToken();
                     });
                 }

                 // Append message to chatbot
                 function appendMessage(text, sender) {
                     const messages = document.getElementById('chatbotMessages');
                     const message = document.createElement('div');
                     message.className = `chatbot-message ${sender}`;
                     message.textContent = text;
                     messages.appendChild(message);
                     messages.scrollTop = messages.scrollHeight;
                 }

                 // Show error message
                 function showError(text) {
                     const error = document.getElementById('chatbotError');
                     error.textContent = text;
                     error.style.display = 'block';
                     setTimeout(() => { error.style.display = 'none'; }, 5000);
                 }

                 // Submit found item to Google Sheet
                 async function submitFoundItem() {
                     try {
                         await initGapiClient();
                         const accessToken = await getAccessToken();
                         gapi.client.setToken({ access_token: accessToken });

                         console.log('Submitting found item to Sheets API');
                         const response = await gapi.client.sheets.spreadsheets.values.append({
                             spreadsheetId: SPREADSHEET_ID,
                             range: 'FoundItems!A:I',
                             valueInputOption: 'USER_ENTERED',
                             resource: {
                                 values: [
                                     [
                                         new Date().toISOString(),
                                         formData.itemId,
                                         formData.itemType,
                                         formData.airport,
                                         formData.description,
                                         formData.foundDate,
                                         formData.foundLocation,
                                         'Available',
                                         formData.reportedBy,
                                         formData.itemId
                                     ]
                                 ]
                             }
                         });

                         console.log('Sheets API response status:', response.status);
                         if (response.status !== 200) {
                             throw new Error(`HTTP error! Status: ${response.status}`);
                         }

                         appendMessage('Found item reported successfully! Item ID: ' + formData.itemId, 'bot');
                         chatState = 'initial';
                         Object.keys(formData).forEach(key => formData[key] = '');
                     } catch (error) {
                         console.error('Submission error:', error.message || error);
                         appendMessage('Failed to submit found item. Please try again.', 'bot');
                         showError('Submission failed: ' + (error.message || 'Unknown error'));
                     }
                 }

                 // Toggle chatbot visibility
                 function toggleChatbot() {
                     const window = document.getElementById('chatbotWindow');
                     window.classList.toggle('open');
                 }

                 // Handle user message
                 function sendMessage() {
                     const input = document.getElementById('chatbotInput');
                     const message = input.value.trim();
                     if (!message) return;

                     appendMessage(message, 'user');
                     input.value = '';

                     // Show typing indicator
                     const typingDiv = document.createElement('div');
                     typingDiv.className = 'chatbot-message bot typing';
                     typingDiv.textContent = '...';
                     document.getElementById('chatbotMessages').appendChild(typingDiv);
                     document.getElementById('chatbotMessages').scrollTop = document.getElementById('chatbotMessages').scrollHeight;

                     setTimeout(() => {
                         typingDiv.remove();
                         let response;

                         switch (chatState) {
                             case 'initial':
                                 if (message.toLowerCase().includes('report found') || message.toLowerCase().includes('found item')) {
                                     response = 'Great! Letâ€™s report a found item. Please provide the Item ID (e.g., LOST-0001-XYZ).';
                                     chatState = 'itemId';
                                 } else if (message.toLowerCase().includes('report') || message.toLowerCase().includes('lost item')) {
                                     response = 'To report a lost item, visit our <a href="Report_Lost_Items.html">Report Lost Items</a> page and fill out the form.';
                                 } else if (message.toLowerCase().includes('track') || message.toLowerCase().includes('status')) {
                                     response = 'You can track your itemâ€™s status on the <a href="track_your_item.html">Track Items</a> page using your email address.';
                                 } else if (message.toLowerCase().includes('claim') || message.toLowerCase().includes('found')) {
                                     response = 'Visit the <a href="claim_item.html">Claim Items</a> page to submit a claim with verification details.';
                                 } else if (message.toLowerCase().includes('support') || message.toLowerCase().includes('contact')) {
                                     response = 'Our 24/7 support team is available via the <a href="contact_support.html">Contact Us</a> page, phone, email, or live chat.';
                                 } else if (message.toLowerCase().includes('hi') || message.toLowerCase().includes('hello')) {
                                     response = 'Hey there! Iâ€™m here to help with lost items. Try asking about reporting a lost item, tracking, claiming, or contact support.';
                                 } else {
                                     response = 'Hmm, Iâ€™m not sure about that. Try asking about reporting a lost item, tracking, claiming, or contacting support.';
                                 }
                                 break;
                             case 'itemId':
                                 if (message.match(/^LOST-\d{4}-[A-Z]{3}$/)) {
                                     formData.itemId = message;
                                     response = 'Got the Item ID. What type of item is it? (electronics, clothing, luggage, jewelry, other)';
                                     chatState = 'itemType';
                                 } else {
                                     response = 'Invalid Item ID. It should be like LOST-XXXX-YYY (e.g., LOST-0001-XYZ). Try again.';
                                 }
                                 break;
                             case 'itemType':
                                 const itemType = message.toLowerCase();
                                 if (validItemTypes.includes(itemType)) {
                                     formData.itemType = itemType;
                                     response = 'Thanks! Which airport was it found at? (LAX, JFK, ORD, ATL, DFW)';
                                     chatState = 'airport';
                                 } else {
                                     response = 'Invalid item type. Choose from: electronics, clothing, luggage, jewelry, other. Try again.';
                                 }
                                 break;
                             case 'airport':
                                 const airport = message.toUpperCase();
                                 if (validAirports.includes(airport)) {
                                     formData.airport = airport;
                                     response = 'Got it. Please provide a description of the item (e.g., color, brand, unique features).';
                                     chatState = 'description';
                                 } else {
                                     response = 'Invalid airport. Choose from: LAX, JFK, ORD, ATL, DFW. Try again.';
                                 }
                                 break;
                             case 'description':
                                 if (message.length >= 5) {
                                     formData.description = message.replace(/[\n\r"\\]/g, ' ').trim();
                                     response = 'When was the item found? (e.g., 2025-05-22)';
                                     chatState = 'foundDate';
                                 } else {
                                     response = 'Description must be at least 5 characters. Try again.';
                                 }
                                 break;
                             case 'foundDate':
                                 if (message.match(/^\d{4}-\d{2}-\d{2}$/)) {
                                     formData.foundDate = message;
                                     response = 'Where was the item found? (e.g., Terminal 3, Gate 12)';
                                     chatState = 'foundLocation';
                                 } else {
                                     response = 'Invalid date format. Use YYYY-MM-DD (e.g., 2025-05-22). Try again.';
                                 }
                                 break;
                             case 'foundLocation':
                                 if (message.length >= 5) {
                                     formData.foundLocation = message.replace(/[\n\r"\\]/g, ' ').trim();
                                     response = 'Who is reporting this item? (e.g., your name or role, like LAX Staff)';
                                     chatState = 'reportedBy';
                                 } else {
                                     response = 'Location must be at least 5 characters. Try again.';
                                 }
                                 break;
                             case 'reportedBy':
                                 if (message.length >= 2) {
                                     formData.reportedBy = message.replace(/[\n\r"\\]/g, ' ').trim();
                                     submitFoundItem();
                                     return;
                                 } else {
                                     response = 'Reporter name must be at least 2 characters. Try again.';
                                 }
                                 break;
                         }

                         appendMessage(response, 'bot');
                         document.getElementById('chatbotMessages').scrollTop = document.getElementById('chatbotMessages').scrollHeight;
                     }, 1000);
                 }

                 // Remove footer if present
                 window.onload = function() {
                     const footer = document.querySelector('article#main footer');
                     if (footer) footer.remove();
                 };
             </script>
         </body>
     </html>